@using BassinoLibrary.Helpers
@using BassinoLibrary.Resource
@using BassinoLibrary.ViewModels
@model BassinoLibrary.ViewModels.CreditoViewModel

@{
    Layout = "~/Views/Shared/_ModalLayout.cshtml";
    ViewBag.Action = "CloseCredit";
}

@section Header
{
    @Helpers.ModalHeader(string.Format("{0} {1}", Resources.Create, "Credito"))
}

<fieldset>
    <div class="alert alert-danger alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <h4><i class="icon fa fa-warning"></i> Alerta</h4>
        Se procedera a dar por pagas las cuotas que queden pendientes.
    </div>
    @Html.ValidationSummary(true)
    @Html.HiddenFor(model => model.Id)
    @Html.PersonalDisplayFor(model => model.Descripcion)
    @Html.PersonalDisplayFor(model => model.ProductoDescripcion)
    @Html.PersonalDisplayFor(model => model.Cliente)
    @Html.PersonalDisplayFor(model => model.Monto)
    @Html.HiddenFor(model => model.Monto)
    @Html.PersonalDisplayFor(model => model.MontoTotal)
    @Html.HiddenFor(model => model.Interes)
    @Html.PersonalDisplayFor(model => model.Interes)
    @Html.PersonalDisplayFor(model => model.NumeroPagos)
    @Html.HiddenFor(model => model.NumeroPagos)
    <input type="hidden" id="UserId" name="UserId" value="@ViewBag.CreateUser">


</fieldset>
<style>
    table {
        border-collapse: collapse;
    }

    table, td, th {
        border: 1px solid black;
        width: 50%;
    }
</style>
<script>
    function SimulateCoutas() {
        var cadena = "";
        var cantidad = $("#NumeroPagos").val();
        var interes = $("#Interes").val();
        var monto = $("#Monto").val();
        $.ajax({
            type: "POST",
            url: "/Credito/SimularCuotas",
            datatype: "JSON",
            data: { cantidad: cantidad, interes: interes, monto: monto },
            success: function (data) {
                $.each(data, function (i, item) {
                    cadena = cadena + "<tr><td>" + item.cuota + "</td><td>" + item.fecha + "</td></tr>";
                });
                $('#tablaSimulada tbody').html(cadena);
            }
        });
    }

    function ProductSelect() {
        var monto = $("#ProductoId").val();
        $.ajax({
            type: "POST",
            url: "/Product/GetDataPrduct",
            datatype: "JSON",
            data: { text: monto },
            success: function (data) {
                $("#Monto").val(data.monto);
                $("#MontoTotal").val(data.monto);
                $("#Interes").val(0, 0);
                $("#Monto").prop('disabled', true);
                $("#MontoTotal").prop('disabled', true);
                $("#Interes").prop('disabled', true);

            }
        });
    }
</script>
@section Footer
{
    @Helpers.BotonesGuardarCancelarModal()
}
